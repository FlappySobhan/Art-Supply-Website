{% extends "../base.html" %}

{% block title %}{{product.name}}{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="row m-0">
        <div id="carouselControls" class="carousel slide my-2 col-md-6" data-bs-ride="true">
            {% if product.picture2 %}
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#carouselControls" data-bs-slide-to="0" class="active"
                    aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#carouselControls" data-bs-slide-to="1"
                    aria-label="Slide 2"></button>
            </div>
            {% endif %}
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="{{product.picture1.url}}" class="d-block w-100" alt="{{product.name}} picture 1">
                </div>
                {% if product.picture2 %}
                <div class="carousel-item">
                    <img src="{{product.picture2.url}}" class="d-block w-100" alt="{{product.name}} picture 2">
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselControls" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselControls" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
            {% else %}
        </div>
        {% endif %}
    </div>
    <div class="col-md-6">
        <div class="d-flex justify-content-between align-items-center border-bottom">
            <h1 class=" pb-3">{{product.name}}</h1>
            {% if user.is_authenticated %}
            <form action="{% url 'product-detail' product.pk %}" method="POST">
                {% csrf_token %}
                {% if is_in_wishlist %}
                <div><button class="btn btn-danger float-end" type="submit" data-bs-toggle="tooltip"
                    title="Remove from wishlist">
                        <i class="bi bi-heart-fill"></i></div>
                {% else %}
                <!-- wishlist button -->
                <div><button class="btn btn-outline-danger float-end" type="submit" data-bs-toggle="tooltip"
                    title="Add to wishlist">
                        <i class="bi bi-heart"></i></div>
                {% endif %}
            </form>
            {% endif %}
        </div>
        <p class="mt-4 lead"><small>{{product.descriptions}}</small></p>
        <div class="mt-4 pt-2 d-flex justify-content-between">
            {% if product.category %}
            <div class="text-start">
                <a href="{% url 'products-list' %}?category={{product.category}}" 
                class="badge text-decoration-none btn-dark">{{product.category}}</a>
            </div>
            {% endif %}
            {% if product.stock < 3 %}
            <div class="text-end">
                <span class="badge bg-danger">Only {{product.stock}} left in stock</span>
            </div>
            {% endif %}
        </div>
        <div class="mt-2 d-flex justify-content-between align-items-center border-top">
            <div class="d-flex">
                {% if product.discount %}
                <span class="text-muted text-decoration-line-through">${{ product.price }}</span>
                {% endif %}
                <p class="display-6"><strong>${{ product.final_price }}</strong></p>
            </div>
            <div><button class="btn btn-primary">Add to cart</button></div>
        </div>
    </div>
</div>
</div>

{% endblock %}
{% block scripts %}
    <script>
        $(function() {
            $('[data-bs-toggle="tooltip"]').tooltip()
        })
    </script>  

{% endblock %}
